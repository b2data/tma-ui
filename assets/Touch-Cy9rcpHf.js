import{j as ae}from"./jsx-runtime-D_zvdyIk.js";import{r as t}from"./index-2yJIXLcc.js";import"./dayjs.min-qj4fShTU.js";import"./file-zip-BXERkKO-.js";import{c as U}from"./dom-Dk7p2m-W.js";function m(n,o,E){const h=t.useRef(o);t.useEffect(()=>{h.current=o},[o]);const i=t.useCallback(l=>h.current&&h.current(l),[]),d=t.useRef(()=>{}),a=t.useCallback(()=>{d.current(),d.current=()=>{}},[]),f=t.useCallback(l=>{if(!U||(a(),!l))return;const g={...E};l.addEventListener(n,i,g),d.current=()=>l.removeEventListener(n,i,g)},[E,i,n,a]);return t.useEffect(()=>a,[a]),t.useMemo(()=>({add:f,remove:a}),[f,a])}const oe=(n,o)=>({startX:n,startY:o,startT:new Date,duration:0,isPressed:!0,isY:!1,isX:!1,isSlideX:!1,isSlideY:!1,isSlide:!1,clientX:0,clientY:0,shiftX:0,shiftY:0,shiftXAbs:0,shiftYAbs:0}),O=n=>n.clientX!=null?n.clientX:n.changedTouches&&n.changedTouches[0].clientX,G=n=>n.clientY!=null?n.clientY:n.changedTouches&&n.changedTouches[0].clientY,H=()=>U&&"ontouchstart"in window,ie=()=>H()?["touchstart","touchmove","touchend","touchcancel"]:["mousedown","mousemove","mouseup","mouseleave"],K=({Component:n="div",onStart:o,onStartX:E,onStartY:h,onMove:i,onMoveX:d,onMoveY:a,onLeave:f,onEnter:l,onEnd:g,onEndX:_,onEndY:z,onClickCapture:T,usePointerHover:w,slideThreshold:M=5,useCapture:P=!1,noSlideClick:F=!1,stopPropagation:J=!1,...Q})=>{const b=t.useMemo(ie,[]),S=t.useRef(!1),r=t.useRef(null),y=(e,s)=>{J&&e.stopPropagation(),s.forEach(u=>{var p,c;const v=Date.now()-(((c=(p=r.current)==null?void 0:p.startT)==null?void 0:c.getTime())??0);u&&u({...r.current,duration:v,originalEvent:e})})},V={capture:P,passive:!1},R=[m(b[1],te,V),m(b[2],q,V),m(b[3],q,V)],W=e=>{e&&R.forEach(s=>s.add(e))},Z=()=>{R.forEach(e=>e.remove())},$=m(w?"pointerenter":"mouseenter",l),ee=m(w?"pointerleave":"mouseleave",f),ne=m(b[0],e=>{r.current=oe(O(e),G(e)),y(e,[o,E,h]),W(H()?e.target:window.document)},{capture:P,passive:!1}),k=t.useRef(null);t.useEffect(()=>{const e=k.current;e&&($.add(e),ee.add(e),ne.add(e))},[n]);function te(e){var x;const{isPressed:s,isX:u,isY:v,startX:p=0,startY:c=0}=r.current??{};if(s){const D=O(e),j=G(e),A=D-p,B=j-c,X=Math.abs(A),Y=Math.abs(B);if(e.touches&&e.touches.length>1){q(e);return}if(!u&&!v){const C=X>=M&&X>Y,I=Y>=M&&Y>X,L=C&&(!!d||!!i),N=I&&(!!a||!!i);r.current&&Object.assign(r.current,{isY:I,isX:C,isSlideX:L,isSlideY:N,isSlide:L||N})}(x=r.current)!=null&&x.isSlide&&(Object.assign(r.current,{clientX:D,clientY:j,shiftX:A,shiftY:B,shiftXAbs:X,shiftYAbs:Y}),y(e,[i,r.current.isSlideX&&d,r.current.isSlideY&&a]))}}function q(e){const{isPressed:s,isSlide:u,isSlideX:v,isSlideY:p}=r.current??{};s&&y(e,[g,p&&z,v&&_]);const c=H();c&&u?S.current=!1:S.current=!!u,r.current={},c&&f&&f(e),Z()}const re=e=>{const s=e.target;(s.tagName==="A"||s.tagName==="IMG")&&e.preventDefault()},se=e=>{if(!S.current){T&&T(e);return}F?(e.stopPropagation(),e.preventDefault()):T&&T(e),S.current=!1};return ae.jsx(n,{...Q,onDragStart:re,onClickCapture:se,ref:k})};try{K.displayName="Touch",K.__docgenInfo={description:`This component is copied from the VKUI library for convenient handling of pointer events
https://github.com/VKCOM/VKUI/blob/master/packages/vkui/src/components/Touch/Touch.tsx#L65`,displayName:"Touch",props:{usePointerHover:{defaultValue:null,description:"",name:"usePointerHover",required:!1,type:{name:"boolean"}},useCapture:{defaultValue:{value:"false"},description:"",name:"useCapture",required:!1,type:{name:"boolean"}},slideThreshold:{defaultValue:{value:"5"},description:"",name:"slideThreshold",required:!1,type:{name:"number"}},noSlideClick:{defaultValue:{value:"false"},description:"",name:"noSlideClick",required:!1,type:{name:"boolean"}},onEnter:{defaultValue:null,description:"",name:"onEnter",required:!1,type:{name:"HoverHandler"}},onLeave:{defaultValue:null,description:"",name:"onLeave",required:!1,type:{name:"HoverHandler"}},onStart:{defaultValue:null,description:"",name:"onStart",required:!1,type:{name:"TouchEventHandler"}},onStartX:{defaultValue:null,description:"",name:"onStartX",required:!1,type:{name:"TouchEventHandler"}},onStartY:{defaultValue:null,description:"",name:"onStartY",required:!1,type:{name:"TouchEventHandler"}},onMove:{defaultValue:null,description:"",name:"onMove",required:!1,type:{name:"TouchEventHandler"}},onMoveX:{defaultValue:null,description:"",name:"onMoveX",required:!1,type:{name:"TouchEventHandler"}},onMoveY:{defaultValue:null,description:"",name:"onMoveY",required:!1,type:{name:"TouchEventHandler"}},onEnd:{defaultValue:null,description:"",name:"onEnd",required:!1,type:{name:"TouchEventHandler"}},onEndX:{defaultValue:null,description:"",name:"onEndX",required:!1,type:{name:"TouchEventHandler"}},onEndY:{defaultValue:null,description:"",name:"onEndY",required:!1,type:{name:"TouchEventHandler"}},stopPropagation:{defaultValue:{value:"false"},description:"",name:"stopPropagation",required:!1,type:{name:"boolean"}},Component:{defaultValue:{value:"div"},description:"",name:"Component",required:!1,type:{name:"ElementType"}}}}}catch{}export{K as T};
